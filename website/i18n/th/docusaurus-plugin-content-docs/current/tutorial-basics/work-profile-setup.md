# การกำหนดค่า Work Profile

TikMatrix รองรับการกำหนดค่าผู้ใช้ Work Profile สำหรับอุปกรณ์แต่ละเครื่องแยกกัน ซึ่งมีประโยชน์มากสำหรับอุปกรณ์ที่จัดการโดยองค์กรหรือสภาพแวดล้อมแอปพลิเคชันคู่

## Work Profile คืออะไร

Work Profile เป็นฟีเจอร์ของ Android ที่อนุญาตให้สร้างสภาพแวดล้อมการทำงานแยกอิสระบนอุปกรณ์เดียวกัน ด้วยการกำหนดค่า User ID ที่แตกต่างกัน คุณสามารถ:

- ใช้ TikMatrix ได้ตามปกติบนอุปกรณ์ที่จัดการโดยองค์กร
- ตั้งค่าผู้ใช้ที่แตกต่างกันสำหรับสภาพแวดล้อมแอปพลิเคชันที่แตกต่างกัน
- บรรลุการจัดการอุปกรณ์และการควบคุมสิทธิ์ที่ละเอียดยิ่งขึ้น

## การใช้เครื่องมือ Shelter เพื่อโคลนแอปพลิเคชัน

ก่อนกำหนดค่า Work Profile คุณต้องใช้เครื่องมือ Shelter เพื่อโคลนแอปพลิเคชัน TikTok และ TikMatrix:

### Shelter คืออะไร

Shelter เป็นแอปพลิเคชันโอเพนซอร์สที่สร้างและจัดการ Work Profile บนอุปกรณ์ Android ช่วยให้คุณสามารถรันแอปพลิเคชันซ้ำในสภาพแวดล้อมการทำงานที่แยกออกมา

### การติดตั้ง Shelter

1. ดาวน์โหลด Shelter จาก [F-Droid](https://f-droid.org/packages/net.typeblog.shelter/) หรือ [Google Play Store](https://play.google.com/store/apps/details?id=net.typeblog.shelter)
2. ติดตั้งและเปิด Shelter บนอุปกรณ์ของคุณ
3. ทำตามวิซาร์ดการตั้งค่าเพื่อสร้าง Work Profile

### การโคลนแอปพลิเคชันที่จำเป็น

หลังจากตั้งค่า Shelter แล้ว คุณต้องโคลนทั้งแอปพลิเคชัน TikTok และ TikMatrix:

1. **โคลนแอปพลิเคชัน TikTok**:
   - เปิด Shelter และไปที่แท็บ "Main"
   - ค้นหา TikTok ในรายการแอปพลิเคชัน
   - แตะปุ่ม "Clone to Work Profile"
   - รอให้กระบวนการโคลนเสร็จสมบูรณ์

2. **โคลนแอปพลิเคชัน TikMatrix**:
   - ใน Shelter ค้นหา TikMatrix ในรายการแอปพลิเคชัน
   - แตะปุ่ม "Clone to Work Profile"
   - ยืนยันการโคลน

### ตรวจสอบความสำเร็จของการโคลน

หลังจากโคลนสำเร็จ:

- คุณจะเห็นทั้ง TikTok และ TikMatrix พร้อมไอคอนกระเป๋าเอกสารในลิ้นชักแอป
- นี่คือเวอร์ชัน Work Profile ของแอปพลิเคชัน
- แอปพลิเคชันต้นฉบับยังคงไม่เปลี่ยนแปลงในโปรไฟล์หลัก

## วิธีการกำหนดค่า Work Profile

### 1. เปิดแถบเครื่องมืออุปกรณ์

เมื่ออุปกรณ์ของคุณเชื่อมต่อและแสดงในอินเทอร์เฟซหลักของ TikMatrix:

1. ดับเบิลคลิกการ์ดอุปกรณ์เพื่อเข้าสู่โหมดเต็มหน้าจอ
2. แถบเครื่องมือจะปรากฏทางด้านขวาของหน้าจออุปกรณ์
3. แถบเครื่องมือถูกยุบตามค่าเริ่มต้นและจะขยายโดยอัตโนมัติเมื่อคุณเลื่อนเมาส์เหนือ

### 2. ค้นหาปุ่ม Work Profile

ที่ด้านล่างของแถบเครื่องมือ คุณจะเห็นปุ่มไอคอนกระเป๋าเอกสาร ซึ่งเป็นปุ่มกำหนดค่า Work Profile

### 3. ตั้งค่า User ID

1. คลิกปุ่มไอคอนกระเป๋าเอกสาร
2. ป้อน User ID ในกล่องโต้ตอบที่ปรากฏ (เช่น 10)
3. คลิกปุ่ม "Save"

### 4. ยืนยันการกำหนดค่า

หลังจากกำหนดค่าสำเร็จ ระบบจะแสดงการแจ้งเตือน "Work Profile user settings saved"

## คำอธิบาย User ID

### User ID ทั่วไป

- **0**: ผู้ใช้หลัก (ผู้ใช้เริ่มต้น)
- **10**: ผู้ใช้ work profile คนแรก
- **11**: ผู้ใช้ work profile คนที่สอง
- User ID เพิ่มเติมตามรูปแบบนี้

### วิธีการค้นหา User ID

หากคุณไม่แน่ใจเกี่ยวกับ User ID บนอุปกรณ์ของคุณ คุณสามารถค้นหาได้โดยใช้:

```bash
adb shell pm list users
```

หรือเรียกใช้ในเครื่องมือดีบักของ TikMatrix:

```bash
pm list users
```

ตัวอย่างผลลัพธ์:

```text
Users:
  UserInfo{0:Owner:c13} running
  UserInfo{10:Work profile:1030} running
```

## การจัดเก็บไฟล์กำหนดค่า

การกำหนดค่า Work Profile จะถูกบันทึกอัตโนมัติไปยังไฟล์ `data/work_profile_user.json` ในรูปแบบดังนี้:

```json
{
  "device_serial_1": "10",
  "device_serial_2": "0",
  "device_serial_3": "11"
}
```

## การจัดการการกำหนดค่าอุปกรณ์

### ดูการกำหนดค่าปัจจุบัน

การกำหนดค่า Work Profile ของอุปกรณ์แต่ละเครื่องเป็นอิสระ คุณสามารถ:

1. ตั้งค่า User ID ที่แตกต่างกันสำหรับอุปกรณ์แต่ละเครื่อง
2. แก้ไขการกำหนดค่าผู้ใช้อุปกรณ์ที่มีอยู่ได้ตลอดเวลา
3. ล้างการกำหนดค่า (ป้อนค่าว่างและบันทึกเพื่อลบการกำหนดค่า)

### การจัดการแบบกลุ่ม

หากคุณต้องการจัดการอุปกรณ์จำนวนมาก คุณสามารถแก้ไขไฟล์ `data/work_profile_user.json` โดยตรง:

1. ปิดแอปพลิเคชัน TikMatrix
2. เปิดไฟล์กำหนดค่า
3. เพิ่มหรือแก้ไขการกำหนดค่าอุปกรณ์ในรูปแบบ JSON
4. รีสตาร์ท TikMatrix

## การแก้ไขปัญหา

### ปัญหาทั่วไป

#### ถาม: คำสั่งล้มเหลวหลังจากตั้งค่า Work Profile

ตอบ: กรุณายืนยัน:

- User ID ถูกต้องหรือไม่
- ผู้ใช้ที่เกี่ยวข้องมีอยู่บนอุปกรณ์หรือไม่
- คุณมีสิทธิ์เพียงพอในการเข้าถึงผู้ใช้นั้นหรือไม่

#### ถาม: วิธียกเลิกการกำหนดค่า Work Profile

ตอบ: ล้างช่องป้อน User ID ในกล่องโต้ตอบการกำหนดค่าและคลิกบันทึก

#### ถาม: ต้องทำอย่างไรถ้าการกำหนดค่าสูญหาย

ตอบ: การกำหนดค่าถูกเก็บในไฟล์ JSON ภายในเครื่อง หากสูญหาย คุณสามารถกำหนดค่าใหม่หรือกู้คืนไฟล์ `data/work_profile_user.json` จากการสำรองข้อมูล

#### ถาม: ปัญหาที่เกี่ยวข้องกับ Shelter

ตอบ: หากคุณพบปัญหากับ Shelter:

- **การโคลนล้มเหลว**: ตรวจสอบว่าคุณมีสิทธิ์ผู้ดูแลระบบและพื้นที่จัดเก็บข้อมูลเพียงพอ
- **แอปที่โคลนไม่ปรากฏ**: ตรวจสอบว่า Work Profile เปิดใช้งานอย่างถูกต้องใน Shelter หรือไม่
- **แอปขัดข้องใน Work Profile**: ลองโคลนแอปพลิเคชันใหม่หรืออัปเดต Shelter
- **ไม่พบแอปที่โคลน**: มองหาแอปที่มีไอคอนกระเป๋าเอกสารในลิ้นชักแอป

## แนวปฏิบัติที่ดีที่สุด

### สภาพแวดล้อมองค์กร

1. **การจัดการแบบรวมศูนย์**: ตั้งค่า User ID เดียวกันสำหรับอุปกรณ์องค์กรทั้งหมด
2. **การแยกสิทธิ์**: ใช้ User ID ที่แตกต่างกันเพื่อแยกระดับสิทธิ์ที่แตกต่างกัน
3. **การสำรองการกำหนดค่า**: สำรองข้อมูลไฟล์ `work_profile_user.json` เป็นประจำ

### การใช้งานส่วนบุคคล

1. **การแยกแอป**: ตั้งค่าสภาพแวดล้อมผู้ใช้ที่แตกต่างกันสำหรับวัตถุประสงค์ที่แตกต่างกัน
2. **สภาพแวดล้อมการทดสอบ**: ใช้ User ID อิสระสำหรับการทดสอบแอป
3. **การปกป้องความเป็นส่วนตัว**: ปรับปรุงความปลอดภัยด้านความเป็นส่วนตัวผ่านการแยกผู้ใช้

### การจัดการเครื่องมือ Shelter

1. **อัปเดตเป็นประจำ**: อัปเดตแอปพลิเคชัน Shelter เพื่อให้แน่ใจว่ามีความเข้ากันได้
2. **การซิงค์แอปพลิเคชัน**: ตรวจสอบให้แน่ใจว่าทั้ง TikTok และ TikMatrix ถูกโคลนก่อนกำหนดค่า Work Profile
3. **การสำรองการตั้งค่า Shelter**: ส่งออกและสำรองการกำหนดค่า Shelter เพื่อการกู้คืนที่ง่าย
4. **ติดตามการอัปเดตแอป**: เมื่อ TikTok หรือ TikMatrix อัปเดต คุณอาจต้องอัปเดตเวอร์ชันที่โคลนด้วย

## รายละเอียดทางเทคนิค

ฟังก์ชัน Work Profile ถูกนำมาใช้โดยการเพิ่มพารามิเตอร์ `--user` ในคำสั่ง ADB:

```bash
# ไม่มี Work Profile
adb shell input tap 100 200

# มี Work Profile (User ID: 10)
adb shell --user 10 input tap 100 200
```

สิ่งนี้ทำให้แน่ใจว่าคำสั่งดำเนินการในสภาพแวดล้อมผู้ใช้ที่ถูกต้อง หลีกเลี่ยงปัญหาสิทธิ์และความขัดแย้งของสภาพแวดล้อม

---

ด้วยการกำหนดค่า Work Profile อย่างเหมาะสม คุณสามารถใช้ TikMatrix ได้อย่างราบรื่นในสภาพแวดล้อมอุปกรณ์ที่ซับซ้อนต่างๆ ปรับปรุงประสิทธิภาพการทำงานและความสะดวกในการจัดการ
