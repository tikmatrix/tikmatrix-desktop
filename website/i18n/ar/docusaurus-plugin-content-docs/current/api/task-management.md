---
sidebar_position: 2
title: API إدارة المهام
description: مرجع كامل لنقاط نهاية إدارة المهام
---

توثق هذه الصفحة جميع نقاط نهاية API المتاحة لإدارة TikMatrix مهام TikMatrix.

## إنشاء مهمة

إنشاء مهمة جديدة لجهاز واحد أو أكثر أو أسماء مستخدمين.

- **نقطة النهاية:** `POST /api/v1/task`
- **Content-Type：** `application/json`

### معاملات الطلب

يدعم API وضعين لإنشاء المهام:

**الوضع 1: وضع الجهاز** - استخدام `serials` لإنشاء مهام للأجهزة
**الوضع 2: وضع اسم المستخدم** - استخدام `usernames` لإنشاء مهام مباشرة لحسابات محددة

| المعاملات | النوع | مطلوب | الوصف |
|------|------|------|------|
| serials | نص[] | مطلوب بشروط | مصفوفة الأرقام التسلسلية للأجهزة（إذا لم يتم توفير `usernames` فهو مطلوب） |
| usernames | نص[] | مطلوب بشروط | مصفوفة أسماء المستخدمين（إذا لم يتم توفير `serials` فهو مطلوب）。عند توفير هذا المعامل، يتم إنشاء مهام مباشرة لهذه الحسابات. |
| script_name | نص | نعم | اسم البرنامج النصي المراد تنفيذه |
| script_config | كائن | نعم | معاملات تكوين البرنامج النصي（راجع وثائق البرنامج النصي المقابل） |
| enable_multi_account | منطقي | لا | ما إذا كان سيتم تمكين وضع الحسابات المتعددة（默认：false）。فعّال فقط في وضع الجهاز. |
| start_time | نص | لا | وقت التنفيذ المجدول，بالتنسيق "HH:MM" |

### 支持的脚本

| 脚本名称 | الوصف | 文档 |
|----------|------|------|
| post | النشرفيديوأوصور到 TikTok/Instagram | [تكوين برنامج النشر النصي](./post-script.md) |

### أمثلة

```bash
curl -X POST http://localhost:50809/api/v1/task \
  -H "Content-Type: application/json" \
  -d '{
    "serials": ["device_serial_1"],
    "script_name": "post",
    "script_config": {
      "content_type": 0,
      "captions": "看看我的新视频！#热门 #推荐",
      "material_list": ["C:/Videos/video1.mp4"],
      "upload_wait_time": 60
    }
  }'
```

有关 `script_config` 的详细المعاملات和更多أمثلة，请参阅 [تكوين برنامج النشر النصي](./post-script.md)。

### 响应

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "task_ids": [101, 102],
    "created_count": 2
  }
}
```

## 列表任务

استخداماختياري过滤条件查询任务。

- **نقطة النهاية:** `GET /api/v1/task`

| المعاملات | النوع | مطلوب | الوصف |
|------|------|------|------|
| status | عدد صحيح | لا | 按状态过滤（0=pending, 1=running, 2=completed, 3=failed） |
| serial | نص | لا | 按设备序列号过滤 |
| script_name | نص | لا | 按脚本名称过滤 |
| source | نص | لا | 按来源过滤（"ui" أو "api"） |
| page | عدد صحيح | لا | 页码（默认：1） |
| page_size | عدد صحيح | لا | 每页条目数（默认：20，最大：100） |

## 获取任务详情

获取指定任务的معلومات تفصيلية。

- **نقطة النهاية:** `GET /api/v1/task/{task_id}`

## 删除任务

删除任务。如果任务正在运行，会先尝试停止它。

- **نقطة النهاية:** `DELETE /api/v1/task/{task_id}`

## 批量删除任务

一次删除多个任务，正在运行的任务会先被停止。

- **نقطة النهاية:** `DELETE /api/v1/task/batch`
- **请求体：** `{ "task_ids": [1, 2, 3] }`

## 停止任务

停止正在运行的任务。

- **نقطة النهاية:** `POST /api/v1/task/{task_id}/stop`

## 重试失败任务

重试单个失败任务。

- **نقطة النهاية:** `POST /api/v1/task/{task_id}/retry`

## 重试所有失败任务

一次性重试所有失败的任务。

- **نقطة النهاية:** `POST /api/v1/task/retry-all`

## 获取任务统计

获取任务总体统计数据。

- **نقطة النهاية:** `GET /api/v1/task/stats`
- **响应：** العودة total、pending、running、completed、failed 的计数。

## 检查 API 许可

检查你的许可证نعملا支持 API 访问。

- **نقطة النهاية:** `GET /api/v1/license/check`
- **ملاحظة：** Starter 计划会العودة错误码 40301；Pro/Team/Business 计划可访问 API。
