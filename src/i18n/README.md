# 国际化（i18n）文件管理

本目录包含项目的所有国际化（i18n）相关文件和工具。

## 目录结构

```paint
i18n/
├── index.js          # 主入口文件，导入所有语言并配置i18n
├── check-and-sync.js # 检查和同步翻译文件的工具
├── package.json      # 包配置
├── README.md         # 本文档
├── backups/          # 翻译文件备份目录（自动创建）
└── locales/          # 语言文件目录（21种语言）
    ├── en.js         # 英语翻译
    ├── zh-CN.js      # 简体中文翻译
    ├── ru.js         # 俄语翻译
    ├── ja.js         # 日语翻译
    ├── ko.js         # 韩语翻译
    ├── es.js         # 西班牙语翻译
    ├── pt.js         # 葡萄牙语翻译
    ├── fr.js         # 法语翻译
    ├── de.js         # 德语翻译
    ├── it.js         # 意大利语翻译
    ├── ar.js         # 阿拉伯语翻译
    ├── hi.js         # 印地语翻译
    ├── id.js         # 印尼语翻译
    ├── th.js         # 泰语翻译
    ├── vi.js         # 越南语翻译
    ├── tr.js         # 土耳其语翻译
    ├── pl.js         # 波兰语翻译
    ├── nl.js         # 荷兰语翻译
    ├── sv.js         # 瑞典语翻译
    ├── he.js         # 希伯来语翻译
    └── uk.js         # 乌克兰语翻译
```

## 翻译检查和同步工具

### 功能特性

#### ✅ 完整性检查

- 检查所有 21 种语言文件中缺失的键
- 显示每种语言的覆盖率
- 确保所有语言包含相同的键

#### ✅ 翻译质量检查

- **未翻译检测**：识别仍为英文的字段
  - 与英文原文完全相同的文本
  - 仅大小写不同的文本
  - 包含明显英文单词和短语的文本
- **智能模式识别**：使用常见英文模式进行检测

#### ✅ 错误语言检测

- 检测使用了错误语言文字系统的翻译
- 支持识别多种文字系统：中文、日文、韩文、阿拉伯文、泰文、印地语、希伯来文、西里尔文、拉丁文

#### ✅ 自动同步和备份

- 自动备份所有语言文件
- 按字母顺序排序所有键
- 用英文填充缺失的翻译
- 生成标准格式的代码

### 使用方法

#### 基本用法

```bash
cd src/i18n
npm run sync
```

#### 命令行选项

```bash
# 仅检查，不修改文件
node check-and-sync.js --check-only

# 跳过翻译质量检查（仅检查完整性）
node check-and-sync.js --skip-quality-check

# 检查特定语言
node check-and-sync.js --lang=zh-CN,ja,ko

# 显示所有问题（不限制输出数量）
node check-and-sync.js --show-all

# 组合使用
node check-and-sync.js --check-only --show-all
```

#### 选项说明

- `--check-only` - 仅执行检查，不生成和更新文件
- `--skip-quality-check` - 跳过翻译质量检查，仅检查键的完整性
- `--lang=<codes>` - 仅检查指定的语言（用逗号分隔）
- `--show-all` - 显示所有问题，不限制输出数量
- `--help` - 显示帮助信息

### 工作流程

1. **检查完整性** - 扫描所有语言文件，收集所有键，检查覆盖情况
2. **翻译质量检查** - 检测未翻译的英文文本和错误语言的文本
3. **生成更新文件** - 备份原始文件，统一所有键，填充缺失翻译，更新文件

### 输出示例

脚本会生成详细的检查报告，包括：

- 每种语言的完整性统计
- 详细的翻译质量问题列表
- 总体汇总报告
- 完美翻译语言列表

### 备份管理

所有备份文件存储在 `backups/` 目录中，按时间戳命名：

```paint
backups/
  └── 2026-01-17T14-02-33-886Z/
      ├── en.js
      ├── zh-CN.js
      └── ...
```

恢复备份：`cp backups/2026-01-17T14-02-33-886Z/* locales/`

## 翻译文件管理

### 添加新的翻译键

当需要添加新的翻译时：

1. 在任意一个语言文件中添加新的键值对
2. 运行 `npm run sync` 脚本，它会自动将新键添加到所有语言文件中
3. 然后为其他语言提供适当的翻译

### 添加新的语言

要添加新的语言支持：

1. 在 `locales` 目录中创建新的语言文件（如 `fr-CA.js`）
2. 在新语言文件中添加基本的翻译结构
3. 在 `check-and-sync.js` 的 `LANGUAGES` 数组中添加新语言配置
4. 运行 `npm run sync` 生成完整的翻译文件
5. 在 `index.js` 中导入并添加到 `messages` 对象中

## 注意事项

1. **自动填充**：脚本会自动用英文填充缺失的翻译，这只是临时占位符，需要人工翻译
2. **技术术语**：某些技术术语（如 "APK", "ID", "IP"）可能被标记为未翻译，可以有意保留
3. **专有名词**：品牌名称（如 "TikTok", "Alipay"）通常不需要翻译
4. **占位符文本**：包含 `{}` 或 URL 的文本会被跳过检查
5. **备份清理**：备份文件不会自动清理，可定期手动删除旧备份

## 最佳实践

- 使用 `npm run sync` 定期检查翻译文件的一致性
- 使用有意义的键名（如 `confirmDelete` 而不是 `message1`）
- 对于缺少翻译的键，暂时使用英文作为默认值
- 在大规模翻译更新前，先运行 `--check-only` 查看问题
- 查看详细报告确定需要翻译的具体字段

## 支持的语言（21种）

英语、简体中文、俄语、日语、韩语、西班牙语、葡萄牙语、法语、德语、意大利语、阿拉伯语、印地语、印尼语、泰语、越南语、土耳其语、波兰语、荷兰语、瑞典语、希伯来语、乌克兰语
